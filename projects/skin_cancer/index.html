<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> LCNet -- Skin Cancer Classification | Spencer Veatch </title> <meta name="author" content="Spencer Veatch"> <meta name="description" content="A lightweight lesion classification network"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/logo.png?7efd43effdfb2e65e3b31947e22771a5"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://scveatch.github.io/projects/skin_cancer/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Spencer</span> Veatch </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/">About</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">Projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/cv/">CV</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">LCNet -- Skin Cancer Classification</h1> <p class="post-description">A lightweight lesion classification network</p> </header> <article> <p>Unlike much other work in this space, the developed model is a singular, relatively lightweight Convolutional Neural Network. The model performs impressively, presenting both strong diagnostic capability and generalization across categories, advancing accurate and efficient deep learning algorithms for skin cancer detection.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/skin_cancer/skin_cancer_model-480.webp 480w,/assets/img/skin_cancer/skin_cancer_model-800.webp 800w,/assets/img/skin_cancer/skin_cancer_model-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/skin_cancer/skin_cancer_model.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The architecture of LCNet </div> <h2 id="background">Background</h2> <p>Convolutional neural networks (CNNs) are biologically inspired models that build on the work of the biologists Hubel and Wiesel. Hubel and Wiesel proposed an explanation for visual processing that built a layered architecture of neurons in the brain, involving 2 categories of cells – complex and simple. Simple cells are primary, and search for simple patterns, while tertiary complex cells combine earlier neural outputs with high-level inputs like spatial information to produce visual perception, even with shifts in the input signal like spatial change. CNNs build on this biological framework, applying the same ideas of local structure, layering, and spatial invariance to their architectures.</p> <p>The most important layer of a CNN is the convolutional layer, which is responsible for extracting features from input signal. This is done using a filter, through a process called convolution. A filter is nothing more than a two-dimensional array of values (called weights) that is systematically passed over the whole of the input data. Convolution is the process by which high-level information is extracted from this data. With every change in position, the model calculates the dot product between the filter and the corresponding cells in the input data, creating a final output called a feature map. The feature map is a representation of the important characteristics of the image, and is used to determine the final output of the model. The key to using convolutional layers in deep learning is that the weights in a filter are adapted as information flows through the model, allowing the models to “learn” how to identify inputs. In the developed model, filters become adapted to identify characteristics of skin cancer like color, texture, and edge irregularity, and ultimately determine the diagnosis.</p> <p>A limitation of convolutional layers is that they are very sensitive to the position of features within an input image, meaning that minor changes can have a significant effect on the model’s output. To compensate for this fact, pooling layers are implemented. A pooling layer is responsible for reducing the dimensionality of the input data, creating an output of lower resolution than the input signal, but retaining major features. Pooling layers move over the input signal in exactly the same way as convolutional layers, creating a filter and performing an operation on the image. Unlike a convolutional layer, however, a pooling layer’s filter is prescribed by the developer, not learned. This model utilizes Maximum pooling (also called Max Pooling for short), which retains only the maximum value for each feature map. The final output of a pooling layer is a summarized version of the features detected in the input, making them integral to model’s generalizing power.</p> <h2 id="lesion-classification-network">Lesion Classification Network</h2> <p>The architecture of the developed CNN, which we will call the lesion classification network (LCNet), accepts images sized to 128x128 with R, G and B channels, followed by a convolutional layer that passes 64 kernels of size 7x7 over the image with a stride value of 2. The primary purpose of this is to develop an immediate sense of features within the spatial domain, utilizing large overlapping kernels to preserve as much surrounding spatial information as possible. The convolution is simple, sliding over the image and transforming the pixel values into a feature map as follows:</p> \[conv[x,y] = \sum_{i = 1}^k(I_{x -i, y -j} \times F_{i,j}, n_c)\] <p>where \(conv[x,y]\) is the output for the pixel values \([x,y]\) in the spatial domain, \(k\) is the size of the kernel, \(I\) is the size of the input image and \(F\) is the kernel with multiple input channels \(nc\). The resulting feature map is passed to the next layer, a max-pooling layer that transforms map regions by taking their maximum value and reducing their size. As a final step before being passed to the next block, feature maps are passed through batch normalization layers, reducing internal covariant shift through the following process:</p> \[\begin{align*} \mu_{\beta} &amp;= \frac{1}{m} \sum_{i = 1}^m x_i \\ \sigma_{\beta}^2 &amp;= \frac{1}{m} \sum_{i = 1}^m (x_i - \mu_{\beta})^2 \\ \hat{x_i} &amp;= \frac{x_i - \mu_{\beta}}{\sqrt{\sigma_{\beta}^2 + \epsilon}} \\ \hat{y_1} &amp;= \gamma \times \hat{x_i} + \beta \end{align*}\] <p>where \(\mu_{\beta}\) and \(\sigma_{\beta}^2\) are the input mean and variance, respectively, and \(x_i\) is the new base value for the input \(x\). Batch normalization extends the base formula further by incorporating learned parameters \(\gamma\) and \(\beta\) to produce the final value \(y_i\). Theoretically, this has the effect of transforming an individual neuron’s activation to a Gaussian distribution, i.e., usually inactive, sometimes a bit active, and rarely very active, decreasing training time and vastly increasing precision. Batch normalization has also been show to reduce the effects of exploding and diminishing gradients, reducing the need for further regularization and increasing the learning rate.</p> <p>Additionally, the LCNet makes extensive use of inception modules, which were popularized with the introduction of the Inception V1 architecture by Szegedy et al. in 2014. Inception modules are particularly effective at reducing computational complexity, making the model wider rather than deeper and thus limiting the effects of overfitting. The most simple implementation performs synchronous convolutions of 1x1, 3x3, and 5x5 kernels over the input signal, passes the resultant feature map to a max pooling layer, and concatenates the outputs to pass to the next layer. The LCNet uses an extended version of this naïve approach, adding an additional 1x1 convolution to limit the number of input channels and significantly improving efficiency. The activation function used is ReLU, a simple, non-linear piecewise function given below.</p> \[RELU(x) = \begin{cases} 0 &amp; \text{if } x \leq 0 \\ x &amp; \text{if } x &gt; 0 \end{cases}\] <p>Unlike other activation functions, ReLU is computationally trivial to implement and is representationally sparse, meaning it is capable of outputting a true zero value, leading to decreases in training time and the overall simplification of the model.</p> <p>This basic structure composes the building blocks of the model, and are repeated in the LCNet to form a deep network capable of extracting information such as edges, colors, textures, and other complex lesion details in the form of a feature map. At the end of the neural network, a flattening layer reduces the dimensionality of the feature map to a one-dimensional array, allowing a one-to-one relation between the cells of feature map and the nodes of the fully connected layer. The model then applies a drop-out layer as a final regularization step. The drop-out layer randomly removes certain nodes from the fully connected layer, limiting the presence of complex and unnecessary adaptations by forcing independent node development. The fully connected layer produces a single feature vector that corresponds to the classification categories and is accepted by a softmax function. The outputs of the fully connected layer are unnormalized log probabilities (also called logits), so a softmax function is applied to transform them into more interpretable normalized linear probabilities.</p> <p>Notably, skin cancer data as a rule is significantly imbalanced, with heavy skew among several classes of cancer. To address the issue of data under-sampling, the model implemented a class weight system, attaching greater importance to images of underrepresented classes. Moreover, strong data augmentation was applied during network training, including rotations from -320 to +320, scaling with factors of 0.5 in both the X and Y direction, and translation by -2 and +2. These operations were only applied to training sets; test sets were not augmented and their original data distribution was used during the testing process. Generally, deep learning networks suffer from computational cost and limited memory, so the original images are rescaled, ensuring contextual data for the lesions are not lost.</p> <p>Additional challenges arise from the noise artifacts present in the imagery. To compensate for this, the model implements a simple segmentation algorithm that separates the pigmented lesion from the healthy skin background. This algorithm utilizes a simple mean threshold against the contrasted image to identify the pigmented tissue, adding a light gaussian blur to minimize the interference of any artefacts. By identifying a region of interest, the model is able to operate efficiently and effectively, increasing its generalizing power and limiting computational demand.</p> <p>The number of learnable parameters in this study is significantly less than many others in the same space, making it less complex and more lightweight. For example, the total learnable parameters used in the study by Iqbal et al. [3] numbered at 256.7M. In contrast, LCNet achieved similarly high performances with only 22M parameters. The network weights are optimized with the Adam algorithm, an extension of stochastic gradient descent that combines the benefits of both AdaGrad and RMSProp. The Adam optimizer is rather simple, calculating the exponential moving average of the gradient and the squared gradient, with the beta parameters controlling the decay of these moving averages. The Adam optimizer has become standard in many deep learning applications given its strong performance. In preliminary testing with the Adam optimizer, the model experienced strong early convergence with the default alpha value of 0.001, but quickly began oscillating. To rectify this, LCNet implements a learning rate decay given by the following:</p> \[\alpha = \frac{1}{(1 + decayRate \times e_i) \times \alpha_0}\] <p>Where \(ei\) is the epoch number and \(\alpha_0\) is the initial learning rate; 0.001 in this case. This is a commonly implemented method that has proven equally effective in this case, preventing weight updates from overcompensating the model. While this did mitigate some effects of the oscillation, the model experienced better performance when the learning rate decay was combined with a modified epsilon value of 0.01. While the initial epsilon of 1e-8 is optimal for larger weight updates, the fine-grained differences between cancerous skin lesions necessitated smaller weight updates and the resulting trade-off of a slightly longer training time.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Spencer Veatch. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"About",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-projects",title:"Projects",description:"Take a look at some of my work!",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"Repositories",description:"Come see what I&#39;ve been working on!",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"CV",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"dropdown-about",title:"About",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-projects",title:"Projects",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-cv",title:"CV",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"post-google-gemini-updates-flash-1-5-gemma-2-and-project-astra",title:'Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra <svg width="1.2rem" height="1.2rem" top=".5rem" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>',description:"We\u2019re sharing updates across our Gemini family of models and a glimpse of Project Astra, our vision for the future of AI assistants.",section:"Posts",handler:()=>{window.open("https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/","_blank")}},{id:"post-displaying-external-posts-on-your-al-folio-blog",title:'Displaying External Posts on Your al-folio Blog <svg width="1.2rem" height="1.2rem" top=".5rem" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>',description:"",section:"Posts",handler:()=>{window.open("https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2","_blank")}},{id:"projects-m3fnet-a-radiogenomic-neural-network",title:"M3FNet -- A Radiogenomic Neural Network",description:"A multi-modal fusion model for MGMT enzyme detection",section:"Projects",handler:()=>{window.location.href="/projects/glioblastoma/"}},{id:"projects-lcnet-skin-cancer-classification",title:"LCNet -- Skin Cancer Classification",description:"A lightweight lesion classification network",section:"Projects",handler:()=>{window.location.href="/projects/skin_cancer/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%73%63%76%65%61%74%63%68@%77%69%6C%6C%61%6D%65%74%74%65.%65%64%75","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/spencer-veatch","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/Spencer Veatch","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>